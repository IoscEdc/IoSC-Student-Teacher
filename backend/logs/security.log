{
  "timestamp": "2025-10-29T08:54:13.990Z",
  "level": "SECURITY",
  "message": "Security event: error_analytics_accessed",
  "data": {
    "userId": "admin123",
    "userRole": "Admin",
    "timeRange": 86400000,
    "includeDetails": false
  }
}
{
  "timestamp": "2025-10-29T09:17:34.954Z",
  "level": "SECURITY",
  "message": "Security event: error_analytics_accessed",
  "data": {
    "userId": "admin123",
    "userRole": "Admin",
    "timeRange": 86400000,
    "includeDetails": false
  }
}
{
  "timestamp": "2025-10-29T11:17:28.327Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:17:28.284Z",
      "data": {
        "operation": "marking",
        "failureCount": 3,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:17:28.282Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:17:28.272Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:17:28.265Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:17:28.352Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:17:28.352Z",
      "data": {
        "operation": "marking",
        "failureCount": 4,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:17:28.340Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:17:28.282Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:17:28.272Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:17:28.360Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:17:28.359Z",
      "data": {
        "operation": "marking",
        "failureCount": 5,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:17:28.358Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:17:28.340Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:17:28.282Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:20:20.247Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:20:20.246Z",
      "data": {
        "operation": "marking",
        "failureCount": 3,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:20:20.245Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.224Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.204Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:20:20.268Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:20:20.268Z",
      "data": {
        "operation": "marking",
        "failureCount": 4,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:20:20.266Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.245Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.224Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:20:20.290Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:20:20.288Z",
      "data": {
        "operation": "marking",
        "failureCount": 5,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:20:20.287Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.266Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.245Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:20:20.325Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:20:20.324Z",
      "data": {
        "operation": "marking",
        "failureCount": 6,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:20:20.307Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.287Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:20:20.266Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:20:30.022Z",
  "level": "SECURITY",
  "message": "Security event: error_analytics_accessed",
  "data": {
    "userId": "admin123",
    "userRole": "Admin",
    "timeRange": 86400000,
    "includeDetails": false
  }
}
{
  "timestamp": "2025-10-29T11:38:52.541Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:38:52.541Z",
      "data": {
        "operation": "marking",
        "failureCount": 3,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:38:52.540Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.536Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.532Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:38:52.594Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:38:52.593Z",
      "data": {
        "operation": "marking",
        "failureCount": 4,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:38:52.592Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.540Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.536Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:38:52.611Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:38:52.603Z",
      "data": {
        "operation": "marking",
        "failureCount": 5,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:38:52.602Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.592Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.540Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-29T11:38:52.620Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-10-29T11:38:52.619Z",
      "data": {
        "operation": "marking",
        "failureCount": 6,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-10-29T11:38:52.618Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.602Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-10-29T11:38:52.592Z",
            "error": {
              "name": "AttendanceAuthorizationError",
              "message": "Teacher not authorized to mark attendance for this class/subject",
              "code": "ATTENDANCE_UNAUTHORIZED",
              "statusCode": 403,
              "stack": "AttendanceAuthorizationError: Teacher not authorized to mark attendance for this class/subject\n    at Object.<anonymous> (W:\\UniO\\IoSC-Student-Teacher\\backend\\tests\\unit\\errorHandling.test.js:256:31)\n    at Promise.finally.completed (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "sessionInfo": {},
              "bulkInfo": null
            },
            "severity": "high",
            "impact": {
              "level": "medium",
              "affectedUsers": 1,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T05:38:11.544Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_slow_response",
      "timestamp": "2025-10-30T05:38:11.537Z",
      "data": {
        "operation": "marking",
        "responseTime": 13688,
        "threshold": 5000,
        "context": {
          "classId": "6902126bf91c442b648f6b95",
          "subjectId": "6902126bf91c442b648f6b9c",
          "teacherId": "6902126bf91c442b648f6ba0",
          "studentCount": 72,
          "successCount": 72,
          "failureCount": 0
        }
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T05:52:58.905Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_slow_response",
      "timestamp": "2025-10-30T05:52:58.900Z",
      "data": {
        "operation": "marking",
        "responseTime": 15464,
        "threshold": 5000,
        "context": {
          "classId": "6902126bf91c442b648f6b95",
          "subjectId": "6902126bf91c442b648f6b9c",
          "teacherId": "6902126bf91c442b648f6ba0",
          "studentCount": 72,
          "successCount": 72,
          "failureCount": 0
        }
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T06:33:18.151Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_slow_response",
      "timestamp": "2025-10-30T06:33:09.940Z",
      "data": {
        "operation": "marking",
        "responseTime": 15707,
        "threshold": 5000,
        "context": {
          "classId": "6902126bf91c442b648f6b95",
          "subjectId": "6902126bf91c442b648f6b9c",
          "teacherId": "6902126bf91c442b648f6ba0",
          "studentCount": 72,
          "successCount": 72,
          "failureCount": 0
        }
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T06:53:16.962Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_slow_response",
      "timestamp": "2025-10-30T06:53:16.955Z",
      "data": {
        "operation": "marking",
        "responseTime": 18134,
        "threshold": 5000,
        "context": {
          "classId": "6902126bf91c442b648f6b95",
          "subjectId": "6902126bf91c442b648f6b9c",
          "teacherId": "6902126bf91c442b648f6ba0",
          "studentCount": 72,
          "successCount": 72,
          "failureCount": 0
        }
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T06:58:18.882Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_slow_response",
      "timestamp": "2025-10-30T06:58:18.878Z",
      "data": {
        "operation": "marking",
        "responseTime": 13440,
        "threshold": 5000,
        "context": {
          "classId": "6902126bf91c442b648f6b95",
          "subjectId": "6902126bf91c442b648f6b9c",
          "teacherId": "6902126bf91c442b648f6ba0",
          "studentCount": 72,
          "successCount": 72,
          "failureCount": 0
        }
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T07:04:59.498Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T07:04:59.449Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T07:04:59.449Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "timestamp": "2025-10-30T07:04:59.449Z",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "totalRecords": 72,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:59.438Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "operation": "marking",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "studentCount": 72,
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "responseTime": 99,
              "category": "attendance",
              "subcategory": "marking"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:48.441Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "timestamp": "2025-10-30T07:04:48.428Z",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "totalRecords": 72,
              "operation": "attendance_generic",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:48.428Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "timestamp": "2025-10-30T07:04:48.428Z",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "totalRecords": 72,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:48.417Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "operation": "marking",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "studentCount": 72,
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "responseTime": 104,
              "category": "attendance",
              "subcategory": "marking"
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T07:04:59.575Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T07:04:59.546Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T07:04:59.546Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "timestamp": "2025-10-30T07:04:59.449Z",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "totalRecords": 72,
              "operation": "attendance_generic",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:59.449Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "timestamp": "2025-10-30T07:04:59.449Z",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "totalRecords": 72,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:59.438Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "operation": "marking",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "studentCount": 72,
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "responseTime": 99,
              "category": "attendance",
              "subcategory": "marking"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:48.441Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "timestamp": "2025-10-30T07:04:48.428Z",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "totalRecords": 72,
              "operation": "attendance_generic",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T07:04:48.428Z",
            "message": "Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future",
            "stack": "DatabaseError: Bulk attendance marking failed: Date range validation failed: Attendance date cannot be more than 0 days in the future\n    at AttendanceService.bulkMarkAttendance (W:\\UniO\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async W:\\UniO\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:96:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6902126bf91c442b648f6ba0",
              "timestamp": "2025-10-30T07:04:48.428Z",
              "classId": "6902126bf91c442b648f6b95",
              "subjectId": "6902126bf91c442b648f6b9c",
              "teacherId": "6902126bf91c442b648f6ba0",
              "date": "2025-10-31",
              "session": "Lecture 1",
              "totalRecords": 72,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T07:15:08.543Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_slow_response",
      "timestamp": "2025-10-30T07:15:08.538Z",
      "data": {
        "operation": "marking",
        "responseTime": 13105,
        "threshold": 5000,
        "context": {
          "classId": "6902126bf91c442b648f6b95",
          "subjectId": "6902126bf91c442b648f6b9c",
          "teacherId": "6902126bf91c442b648f6ba0",
          "studentCount": 72,
          "successCount": 72,
          "failureCount": 0
        }
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T10:38:05.779Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T10:38:05.743Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T10:38:05.742Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:03.292Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:03.202Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:01.429Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:01.348Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T10:38:06.465Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T10:38:06.408Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T10:38:06.408Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:05.742Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:03.292Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:03.202Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:01.429Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T10:39:18.660Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T10:39:18.631Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T10:39:18.631Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:06.408Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:05.742Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:03.292Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:03.202Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T10:39:18.789Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T10:39:18.763Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T10:39:18.763Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:39:18.631Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:06.408Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:05.742Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:38:03.292Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T10:59:18.711Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T10:59:18.679Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T10:59:18.675Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:58:59.134Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:58:59.049Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:58:58.085Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:58:58.007Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T10:59:18.885Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T10:59:18.861Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T10:59:18.861Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:59:18.675Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:58:59.134Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:58:59.049Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T10:58:58.085Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T12:55:55.250Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T12:55:55.068Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T12:55:55.068Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:53.966Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:53.895Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:52.987Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:52.911Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T12:55:55.376Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T12:55:55.350Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T12:55:55.350Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:55.068Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:53.966Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:53.895Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:52.987Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T12:55:57.509Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T12:55:57.486Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T12:55:57.485Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:55.350Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:55.068Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:53.966Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:53.895Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T12:56:02.955Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T12:56:02.931Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T12:56:02.931Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:57.485Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:55.350Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:55.068Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:53.966Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T12:56:03.150Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T12:56:03.052Z",
      "data": {
        "count": 9,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T12:56:03.052Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:56:02.931Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:57.485Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:55.350Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T12:55:55.068Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:23.614Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:23.552Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:23.552Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:50.632Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:50.550Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:42.649Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:42.574Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:23.836Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:23.803Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:23.803Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.552Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:50.632Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:50.550Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:42.649Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:25.548Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:25.518Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:25.518Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.803Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.552Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:50.632Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:50.550Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:25.712Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:25.675Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:25.675Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.518Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.803Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.552Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:04:50.632Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:33.515Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:33.479Z",
      "data": {
        "count": 9,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:33.479Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.675Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.518Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.803Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.552Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:33.649Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:33.622Z",
      "data": {
        "count": 10,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:33.622Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:33.479Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.675Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.518Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:23.803Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:43.917Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:43.877Z",
      "data": {
        "count": 11,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:43.876Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:33.622Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:33.479Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.675Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.518Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T13:06:44.114Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T13:06:44.082Z",
      "data": {
        "count": 12,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T13:06:44.082Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:43.876Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:33.622Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:33.479Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T13:06:25.675Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T14:22:03.293Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T14:22:03.255Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T14:22:03.255Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:21:06.564Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:21:06.488Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:21:02.946Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:21:02.490Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T14:22:03.476Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T14:22:03.444Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T14:22:03.444Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:22:03.255Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:21:06.564Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:21:06.488Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T14:21:02.946Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:07:26.581Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:07:26.520Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:07:26.514Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:24.641Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:24.562Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:06:47.423Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:06:47.225Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:07:26.887Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:07:26.837Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:07:26.837Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:26.514Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:24.641Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:24.562Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:06:47.423Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:07:29.111Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:07:29.074Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:07:29.074Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:26.837Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:26.514Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:24.641Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:24.562Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:07:29.279Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:07:29.251Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:07:29.251Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:29.074Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:26.837Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:26.514Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:07:24.641Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:46:48.215Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:46:48.183Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:46:48.183Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:47.707Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:46.922Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:45:42.060Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:45:41.979Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:46:48.589Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:46:48.559Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:46:48.558Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:48.183Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:47.707Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:46.922Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:45:42.060Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:46:49.057Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:46:49.026Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:46:49.026Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:48.558Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:48.183Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:47.707Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:46:46.922Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:49:13.573Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:49:13.548Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:49:13.547Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:49:10.468Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:49:10.378Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:48:59.259Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:48:59.170Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T15:50:19.571Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T15:50:19.536Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T15:50:19.536Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:49:13.547Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:49:10.468Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:49:10.378Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T15:48:59.259Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:04:34.448Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:04:34.413Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:04:34.412Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:26.396Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:26.226Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:03:43.540Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:03:43.470Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:04:34.647Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:04:34.616Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:04:34.615Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.412Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:26.396Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:26.226Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:03:43.540Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:04:38.726Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:04:38.629Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:04:38.629Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.615Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.412Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:26.396Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:26.226Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:04:38.908Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:04:38.880Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:04:38.879Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.629Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.615Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.412Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:26.396Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:04:43.593Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:04:43.562Z",
      "data": {
        "count": 9,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:04:43.562Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.879Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.629Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.615Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.412Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:04:43.731Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:04:43.700Z",
      "data": {
        "count": 10,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:04:43.699Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:43.562Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.879Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.629Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:34.615Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:07:20.023Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:07:19.999Z",
      "data": {
        "count": 11,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:07:19.999Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:43.699Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:43.562Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.879Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.629Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:07:20.515Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:07:20.485Z",
      "data": {
        "count": 12,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:07:20.485Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:07:19.999Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:43.699Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:43.562Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:04:38.879Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:13:09.761Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:13:09.710Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:13:09.710Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:13:05.830Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:13:05.740Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:10:36.191Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:10:36.115Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:13:09.972Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:13:09.947Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:13:09.947Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:13:09.710Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:13:05.830Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:13:05.740Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:10:36.191Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:20:18.573Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:20:18.535Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:20:18.534Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.451Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:18:20.347Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:18:08.326Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:17:38.355Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:20:23.295Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:20:23.259Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:20:23.259Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.534Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.451Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:18:20.347Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:18:08.326Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:20:23.471Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:20:23.441Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:20:23.441Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.259Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.534Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.451Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:18:20.347Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:20:35.160Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:20:35.130Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:20:35.129Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.441Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.259Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.534Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.451Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:20:35.308Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:20:35.278Z",
      "data": {
        "count": 9,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:20:35.278Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:35.129Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.441Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.259Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:18.534Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:24:54.732Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:24:54.688Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:24:54.688Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:35.278Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:35.129Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.441Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.259Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:24:54.886Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:24:54.863Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:24:54.863Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:24:54.688Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:35.278Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:35.129Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:20:23.441Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:28:30.110Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:28:30.078Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:28:30.078Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:27:22.261Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:27:22.187Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:24:54.863Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:24:54.688Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:28:30.246Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:28:30.220Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:28:30.220Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.078Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:27:22.261Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:27:22.187Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:24:54.863Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:28:41.306Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:28:41.274Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:28:41.274Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.220Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.078Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:27:22.261Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:27:22.187Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:28:41.448Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:28:41.418Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:28:41.418Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.274Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.220Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.078Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:27:22.261Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:28:43.324Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:28:43.298Z",
      "data": {
        "count": 9,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:28:43.298Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.418Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.274Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.220Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.078Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:28:43.466Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:28:43.438Z",
      "data": {
        "count": 10,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:28:43.438Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.298Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.418Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.274Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:30.220Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:30:19.366Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:30:19.337Z",
      "data": {
        "count": 9,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:30:19.336Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.438Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.298Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.418Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.274Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:31:49.097Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:31:49.055Z",
      "data": {
        "count": 10,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:31:49.054Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:30:19.336Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.438Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.298Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:41.418Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:31:49.382Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:31:49.345Z",
      "data": {
        "count": 11,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:31:49.345Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.054Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:30:19.336Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.438Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.298Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:32:15.712Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:32:15.673Z",
      "data": {
        "count": 12,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:32:15.673Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.345Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.054Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:30:19.336Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:28:43.438Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:32:15.882Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:32:15.853Z",
      "data": {
        "count": 13,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:32:15.853Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:32:15.673Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.345Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.054Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:30:19.336Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:33:28.394Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:33:28.367Z",
      "data": {
        "count": 12,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:33:28.367Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:32:15.853Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:32:15.673Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.345Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.054Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:34:50.050Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:34:49.910Z",
      "data": {
        "count": 7,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:34:49.910Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:33:28.367Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:32:15.853Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:32:15.673Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:31:49.345Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-10-30T16:34:50.300Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-10-30T16:34:50.271Z",
      "data": {
        "count": 8,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-10-30T16:34:50.271Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:34:49.910Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:33:28.367Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:32:15.853Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-10-30T16:32:15.673Z",
            "message": "error.toJSON is not a function",
            "stack": "AppError: error.toJSON is not a function\n    at errorHandler (W:\\UniO\\IoSC-Student-Teacher\\backend\\middleware\\errorMiddleware.js:49:17)\n    at Layer.handle_error (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15\n    at Immediate.next (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:265:14)\n    at Immediate._onImmediate (W:\\UniO\\IoSC-Student-Teacher\\backend\\node_modules\\express\\lib\\router\\index.js:646:15)\n    at process.processImmediate (node:internal/timers:487:21)",
            "name": "AppError",
            "code": "INTERNAL_SERVER_ERROR",
            "statusCode": 500,
            "context": {
              "url": "/api/attendance/summary/student/690213114a29841c1f2a63ac",
              "method": "GET",
              "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36",
              "ipAddress": "::1",
              "userId": "690213114a29841c1f2a63ac",
              "userRole": "Student",
              "endpoint": "GET /api/attendance/summary/student/690213114a29841c1f2a63ac",
              "query": {},
              "params": {}
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-11-03T02:40:23.883Z",
  "level": "SECURITY",
  "message": "Security event: attendance_administrator_alert",
  "data": {
    "alert": {
      "type": "attendance_consecutive_failures",
      "timestamp": "2025-11-03T02:40:23.881Z",
      "data": {
        "operation": "marking",
        "failureCount": 3,
        "timeWindow": 15,
        "errors": [
          {
            "timestamp": "2025-11-03T02:40:23.881Z",
            "error": {
              "name": "DatabaseError",
              "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
              "code": "DATABASE_ERROR",
              "statusCode": 500,
              "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "sessionInfo": {
                "date": "2025-11-03",
                "session": "Lecture 1"
              },
              "bulkInfo": null
            },
            "severity": "critical",
            "impact": {
              "level": "medium",
              "affectedUsers": 10,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-11-03T02:36:26.068Z",
            "error": {
              "name": "DatabaseError",
              "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
              "code": "DATABASE_ERROR",
              "statusCode": 500,
              "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "sessionInfo": {
                "date": "2025-11-03",
                "session": "Lecture 1"
              },
              "bulkInfo": null
            },
            "severity": "critical",
            "impact": {
              "level": "medium",
              "affectedUsers": 10,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          },
          {
            "timestamp": "2025-11-03T02:26:27.543Z",
            "error": {
              "name": "DatabaseError",
              "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
              "code": "DATABASE_ERROR",
              "statusCode": 500,
              "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24"
            },
            "context": {
              "operation": "marking",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "sessionInfo": {
                "date": "2025-11-03",
                "session": "Lecture 1"
              },
              "bulkInfo": null
            },
            "severity": "critical",
            "impact": {
              "level": "medium",
              "affectedUsers": 10,
              "affectedOperations": [
                "marking"
              ],
              "businessImpact": "moderate"
            }
          }
        ]
      },
      "severity": "high",
      "category": "attendance"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu",
      "attendance-admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-11-03T02:40:23.895Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-11-03T02:40:23.892Z",
      "data": {
        "count": 5,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-11-03T02:40:23.891Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "timestamp": "2025-11-03T02:40:23.891Z",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "totalRecords": 1,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:40:23.886Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "operation": "marking",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "studentCount": 1,
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "responseTime": 117,
              "category": "attendance",
              "subcategory": "marking"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:36:26.072Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "timestamp": "2025-11-03T02:36:26.071Z",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "totalRecords": 1,
              "operation": "attendance_generic",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:36:26.071Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "timestamp": "2025-11-03T02:36:26.071Z",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "totalRecords": 1,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:36:26.069Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "operation": "marking",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "studentCount": 1,
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "responseTime": 134,
              "category": "attendance",
              "subcategory": "marking"
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
{
  "timestamp": "2025-11-03T02:40:23.904Z",
  "level": "SECURITY",
  "message": "Security event: administrator_alert",
  "data": {
    "alert": {
      "type": "critical_error_threshold",
      "timestamp": "2025-11-03T02:40:23.902Z",
      "data": {
        "count": 6,
        "timeWindow": 5,
        "errors": [
          {
            "timestamp": "2025-11-03T02:40:23.902Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "timestamp": "2025-11-03T02:40:23.891Z",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "totalRecords": 1,
              "operation": "attendance_generic",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:40:23.891Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "timestamp": "2025-11-03T02:40:23.891Z",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "totalRecords": 1,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:40:23.886Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "operation": "marking",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "studentCount": 1,
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "responseTime": 117,
              "category": "attendance",
              "subcategory": "marking"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:36:26.072Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "timestamp": "2025-11-03T02:36:26.071Z",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "totalRecords": 1,
              "operation": "attendance_generic",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          },
          {
            "timestamp": "2025-11-03T02:36:26.071Z",
            "message": "Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: ",
            "stack": "DatabaseError: Bulk attendance marking failed: Session configuration validation failed: Invalid session \"Lecture 1\". Valid sessions are: \n    at AttendanceService.bulkMarkAttendance (C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\services\\AttendanceService.js:213:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Lenovo\\OneDrive\\Desktop\\IOSC\\IoSC-Student-Teacher\\backend\\controllers\\attendanceController.js:100:24",
            "name": "DatabaseError",
            "code": "DATABASE_ERROR",
            "statusCode": 500,
            "context": {
              "method": "POST",
              "path": "/mark",
              "userRole": "Teacher",
              "userId": "6906ba37e8663e966141ca47",
              "timestamp": "2025-11-03T02:36:26.071Z",
              "classId": "6906afc0cc59f531bb1e949f",
              "subjectId": "6906c81d0fb3897fd4284849",
              "teacherId": "6906ba37e8663e966141ca47",
              "date": "2025-11-03",
              "session": "Lecture 1",
              "totalRecords": 1,
              "operation": "attendance_marking",
              "errorCategory": "attendance"
            },
            "severity": "critical"
          }
        ]
      },
      "severity": "high"
    },
    "notificationSent": true,
    "recipients": [
      "admin@school.edu"
    ]
  }
}
